{"version":3,"file":"embedChat.js","sources":["../../../src/js/components/embedChat.ts"],"sourcesContent":["// Usage:\n// <div id=\"levelup-chat-embed\"></div>\n// <script type=\"module\">\n//   import { embedChat } from \"https://cdn.jsdelivr.net/gh/highlevelthemes/levelup@v1.7/js/components/chatEmbed.js\";\n//   embedChat();\n// </script>\n\nconst CHAT_EMBED_CONTAINER_SELECTOR = \"#levelup-chat-embed\"\nconst MAX_ATTEMPTS = 20\n\nexport const embedChat = (attempts = 1) => {\n  const embedDiv = document.querySelector(\n    CHAT_EMBED_CONTAINER_SELECTOR\n  ) as HTMLElement\n  if (!embedDiv) {\n    return\n  }\n  const retry = () => {\n    if (attempts > MAX_ATTEMPTS) {\n      console.warn(\"__theme_name__: embedChat max attempts reached\")\n      return\n    }\n    setTimeout(() => {\n      embedChat(attempts + 1)\n    }, 50 * attempts + 100)\n  }\n\n  const chat = document.querySelector(\"chat-widget\")\n  const root = chat?.shadowRoot\n\n  if (!chat || !root) {\n    return retry()\n  }\n\n  const button = root.querySelector(\".lc_text-widget--btn\") as HTMLElement\n  const widget = root.querySelector(\".lc_text-widget\") as HTMLElement\n  const box = root.querySelector(\".lc_text-widget--box\") as HTMLElement\n  const heading = root.querySelector(\n    \".lc_text-widget_heading--root\"\n  ) as HTMLElement\n\n  if (!button || !widget || !box || !heading) {\n    return retry()\n  }\n\n  chat.parentElement?.removeChild(chat)\n\n  // TODO: if mobile, don't set position: static\n  // TODO: set overscroll to auto\n\n  widget.style.position = \"static\"\n  widget.style.width = \"100%\"\n  box.style.maxWidth = \"100%\"\n  // heading.style.background = \"white\"\n\n  // TODO: wait until after button click or observe DOM before attempting to get inner-scroll\n  // const innerscroll = root\n  //   .querySelector(\"chat-pane\")\n  //   .shadowRoot.querySelector(\"chat-conversation\")\n  //   .shadowRoot.querySelector(\"ion-content\")\n  //   .shadowRoot.querySelector(\".inner-scroll\") as HTMLElement\n  // if (inner?.style) {\n  //   inner.style.overscrollBehavior = \"auto\"\n  // }\n  // TODO: set ::slotted(.informational) fontSize = 14px\n\n  embedDiv.appendChild(chat)\n\n  button?.click()\n\n  button.style.display = \"none\"\n}\n"],"names":[],"mappings":";;;;;;AAOA,MAAM,6BAAgC,GAAA,qBAAA,CAAA;AACtC,MAAM,YAAe,GAAA,EAAA,CAAA;AAER,MAAA,SAAA,GAAY,CAAC,QAAA,GAAW,CAAM,KAAA;AAV3C,EAAA,IAAA,EAAA,CAAA;AAWE,EAAA,MAAM,WAAW,QAAS,CAAA,aAAA;AAAA,IACxB,6BAAA;AAAA,GACF,CAAA;AACA,EAAA,IAAI,CAAC,QAAU,EAAA;AACb,IAAA,OAAA;AAAA,GACF;AACA,EAAA,MAAM,QAAQ,MAAM;AAClB,IAAA,IAAI,WAAW,YAAc,EAAA;AAC3B,MAAA,OAAA,CAAQ,KAAK,gDAAgD,CAAA,CAAA;AAC7D,MAAA,OAAA;AAAA,KACF;AACA,IAAA,UAAA,CAAW,MAAM;AACf,MAAA,SAAA,CAAU,WAAW,CAAC,CAAA,CAAA;AAAA,KACxB,EAAG,EAAK,GAAA,QAAA,GAAW,GAAG,CAAA,CAAA;AAAA,GACxB,CAAA;AAEA,EAAM,MAAA,IAAA,GAAO,QAAS,CAAA,aAAA,CAAc,aAAa,CAAA,CAAA;AACjD,EAAA,MAAM,OAAO,IAAM,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,IAAA,CAAA,UAAA,CAAA;AAEnB,EAAI,IAAA,CAAC,IAAQ,IAAA,CAAC,IAAM,EAAA;AAClB,IAAA,OAAO,KAAM,EAAA,CAAA;AAAA,GACf;AAEA,EAAM,MAAA,MAAA,GAAS,IAAK,CAAA,aAAA,CAAc,sBAAsB,CAAA,CAAA;AACxD,EAAM,MAAA,MAAA,GAAS,IAAK,CAAA,aAAA,CAAc,iBAAiB,CAAA,CAAA;AACnD,EAAM,MAAA,GAAA,GAAM,IAAK,CAAA,aAAA,CAAc,sBAAsB,CAAA,CAAA;AACrD,EAAA,MAAM,UAAU,IAAK,CAAA,aAAA;AAAA,IACnB,+BAAA;AAAA,GACF,CAAA;AAEA,EAAA,IAAI,CAAC,MAAU,IAAA,CAAC,UAAU,CAAC,GAAA,IAAO,CAAC,OAAS,EAAA;AAC1C,IAAA,OAAO,KAAM,EAAA,CAAA;AAAA,GACf;AAEA,EAAK,CAAA,EAAA,GAAA,IAAA,CAAA,aAAA,KAAL,mBAAoB,WAAY,CAAA,IAAA,CAAA,CAAA;AAKhC,EAAA,MAAA,CAAO,MAAM,QAAW,GAAA,QAAA,CAAA;AACxB,EAAA,MAAA,CAAO,MAAM,KAAQ,GAAA,MAAA,CAAA;AACrB,EAAA,GAAA,CAAI,MAAM,QAAW,GAAA,MAAA,CAAA;AAcrB,EAAA,QAAA,CAAS,YAAY,IAAI,CAAA,CAAA;AAEzB,EAAQ,MAAA,IAAA,IAAA,GAAA,KAAA,CAAA,GAAA,MAAA,CAAA,KAAA,EAAA,CAAA;AAER,EAAA,MAAA,CAAO,MAAM,OAAU,GAAA,MAAA,CAAA;AACzB;;;;"}