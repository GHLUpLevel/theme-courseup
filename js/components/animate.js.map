{"version":3,"file":"animate.js","sources":["../../../src/js/components/animate.ts"],"sourcesContent":["/**\n * Animate & Adorn\n */\n\n// Animates elements when scrolled into view.\n// When page loads, animation classes are removed from elements\n// then added back when scrolled into view.\n\n// TODO: for infinite animations, keep observer active\n//    and disable animation when out of view\n\nconst SELECTOR = \":is([class*=animate-], [class*=adorn-])\"\nconst PLAY_CLASS = \"animate-play\"\n\n// List of animation classes partial matches that require parent overflow:clip.\n// Prevents side scrolling of the page due to animation or adornment position.\nconst CLIP_CLASSES = [\"animate-fadeIn\", \"adorn-\"]\n\ninterface AnimateElem extends HTMLElement {\n  dataset: {\n    animate: string\n  }\n}\n\nconst observer = new IntersectionObserver((entries) => {\n  entries.forEach((entry) => {\n    if (entry.isIntersecting) {\n      const elem = entry.target as AnimateElem\n      observer.unobserve(elem)\n      elem.classList.add(PLAY_CLASS)\n    }\n  })\n})\n\nconst needsClipping = (classList: DOMTokenList) => {\n  for (const cls of CLIP_CLASSES) {\n    if (classList.value.includes(cls)) {\n      return true\n    }\n  }\n  return false\n}\n\nconst run = () => {\n  document\n    .querySelectorAll<AnimateElem>(SELECTOR)\n    .forEach((elem: HTMLElement) => {\n      if (needsClipping(elem.classList) && elem.parentElement) {\n        const section = elem.closest(\".c-section\") as HTMLElement | null\n        const clipElem = section ? section : elem.parentElement\n        clipElem.style.overflowX = \"clip\"\n      }\n      observer.observe(elem)\n    })\n}\n\nexport default {\n  run,\n}\n"],"names":[],"mappings":";;;;;;AAWA,MAAM,QAAW,GAAA,yCAAA,CAAA;AACjB,MAAM,UAAa,GAAA,cAAA,CAAA;AAInB,MAAM,YAAA,GAAe,CAAC,gBAAA,EAAkB,QAAQ,CAAA,CAAA;AAQhD,MAAM,QAAW,GAAA,IAAI,oBAAqB,CAAA,CAAC,OAAY,KAAA;AACrD,EAAQ,OAAA,CAAA,OAAA,CAAQ,CAAC,KAAU,KAAA;AACzB,IAAA,IAAI,MAAM,cAAgB,EAAA;AACxB,MAAA,MAAM,OAAO,KAAM,CAAA,MAAA,CAAA;AACnB,MAAA,QAAA,CAAS,UAAU,IAAI,CAAA,CAAA;AACvB,MAAK,IAAA,CAAA,SAAA,CAAU,IAAI,UAAU,CAAA,CAAA;AAAA,KAC/B;AAAA,GACD,CAAA,CAAA;AACH,CAAC,CAAA,CAAA;AAED,MAAM,aAAA,GAAgB,CAAC,SAA4B,KAAA;AACjD,EAAA,KAAA,MAAW,OAAO,YAAc,EAAA;AAC9B,IAAA,IAAI,SAAU,CAAA,KAAA,CAAM,QAAS,CAAA,GAAG,CAAG,EAAA;AACjC,MAAO,OAAA,IAAA,CAAA;AAAA,KACT;AAAA,GACF;AACA,EAAO,OAAA,KAAA,CAAA;AACT,CAAA,CAAA;AAEA,MAAM,MAAM,MAAM;AAChB,EAAA,QAAA,CACG,gBAA8B,CAAA,QAAQ,CACtC,CAAA,OAAA,CAAQ,CAAC,IAAsB,KAAA;AAC9B,IAAA,IAAI,aAAc,CAAA,IAAA,CAAK,SAAS,CAAA,IAAK,KAAK,aAAe,EAAA;AACvD,MAAM,MAAA,OAAA,GAAU,IAAK,CAAA,OAAA,CAAQ,YAAY,CAAA,CAAA;AACzC,MAAM,MAAA,QAAA,GAAW,OAAU,GAAA,OAAA,GAAU,IAAK,CAAA,aAAA,CAAA;AAC1C,MAAA,QAAA,CAAS,MAAM,SAAY,GAAA,MAAA,CAAA;AAAA,KAC7B;AACA,IAAA,QAAA,CAAS,QAAQ,IAAI,CAAA,CAAA;AAAA,GACtB,CAAA,CAAA;AACL,CAAA,CAAA;AAEA,cAAe;AAAA,EACb,GAAA;AACF,CAAA;;;;"}