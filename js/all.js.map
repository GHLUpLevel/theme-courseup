{"version":3,"file":"all.js","sources":["../../src/js/components/show-more.ts","../../src/js/all.ts"],"sourcesContent":["/**\n * Show More Button & Rows\n */\n\n//  This is useful since GHL's built-in show/hide section feature on buttons requires\n//  the element to be shown is already hidden in the editor. Hidden elements are hard\n//  to edit since they need to be manually unhidden in the layers panel, edited, and\n//  then hidden again.\n//\n//  To use this Show More feature, add a .show-more class to a trigger button and then\n//  add the .show-more class to one or more rows beneath the button. On load, the rows\n//  will be auto hidden until the button is clicked.\n\nconst SEL_BTN_MORE = \".c-button .show-more-btn\"\nconst SEL_BTN_LESS = \".c-button .show-less-btn\"\nconst SEL_ROWS = \".c-row.show-more\"\n// Class added to rows after show more buttin is clicked\nconst SHOWN_CLASS = \"show-more-shown\"\n// Class added to elements when show more is disabled\nconst DISABLED_CLASS = \"show-more-disabled\"\n\ntype Listener = (this: HTMLElement, event: Event) => void\n\nconst addClickListeners = (btnRow: Element, listener: Listener) => {\n  btnRow.querySelectorAll(`${SEL_BTN_MORE},${SEL_BTN_LESS}`).forEach((btn: Element) => {\n    btn.addEventListener(\"click\", listener)\n  })\n}\n\nconst toggleClass = (elem: HTMLElement, show: boolean) => {\n  if (show) {\n    elem.classList.add(SHOWN_CLASS)\n  } else {\n    elem.classList.remove(SHOWN_CLASS)\n  }\n}\n\nconst observeAndListen = (\n  trigger: HTMLElement,\n  parentRow: HTMLElement,\n  rows: NodeListOf<HTMLElement>\n) => {\n  function listener(this: HTMLElement, event: Event) {\n    event.preventDefault()\n    event.stopImmediatePropagation()\n\n    // Disconnect the observer since we know clicks are working\n    observer.disconnect()\n\n    const isShown = parentRow.classList.contains(SHOWN_CLASS)\n    rows.forEach((row) => {\n      toggleClass(row, !isShown)\n    })\n    toggleClass(parentRow, !isShown)\n  }\n\n  if (!trigger.parentNode || !parentRow) {\n    return\n  }\n\n  const observer = new MutationObserver((list, obs) => {\n    // Trigger removed from DOM\n    if (!trigger.parentNode) {\n      // Cleanup old listener\n      trigger.removeEventListener(\"click\", listener)\n      // Attach new listeners\n      addClickListeners(parentRow, listener)\n    }\n  })\n  observer.observe(trigger.parentNode, { childList: true })\n  addClickListeners(parentRow, listener)\n}\n\nconst run = () => {\n  // Get all trigger elements\n  document.querySelectorAll<HTMLElement>(SEL_BTN_MORE).forEach((trigger) => {\n    // Get the row containing the trigger button\n    const parentRow = trigger.closest<HTMLElement>(\".c-row\")\n    if (!parentRow) {\n      return\n    }\n\n    // Find all sibling rows with the '.show-more' class\n    const rows = parentRow.parentNode?.querySelectorAll<HTMLElement>(SEL_ROWS)\n\n    if (!rows || rows.length === 0) {\n      parentRow.classList.add(DISABLED_CLASS)\n    } else {\n      observeAndListen(trigger, parentRow, rows)\n    }\n  })\n}\n\nconst init = () => {\n  if (\n    document.readyState === \"complete\" ||\n    document.readyState === \"interactive\"\n  ) {\n    setTimeout(run, 10)\n  } else {\n    document.addEventListener(\"DOMContentLoaded\", () => {\n      setTimeout(run, 10)\n    })\n  }\n}\n\nexport default {\n  init,\n  run,\n}\n","import showMore from \"./components/show-more\"\n\nshowMore.init()\n"],"names":[],"mappings":"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"}